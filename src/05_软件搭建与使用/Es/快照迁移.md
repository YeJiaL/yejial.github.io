es 快照迁移

# [Elastic数据迁移方法及注意事项](https://www.cnblogs.com/mikeguan/p/7355944.html)

windows下elasticsearch.yml配置

```
http.cors.enabled: true 
http.cors.allow-origin: "*"
node.master: true
node.data: true
network.host: 0.0.0.0
cluster.name: uihMapp
node.name: yjl
http.port: 9200
discovery.zen.ping.unicast.hosts: ["127.0.0.1"]
path.repo: D:\software\elasticsearch-6.2.2\elasticsearch-6.2.2\backup
```



```
// 创建ES仓库my_backup
http://192.168.1.1:9200/_plugin/head/的复合查询，通过PUT进行发送请求：
PUT _snapshot/my_backup 
{
    "type": "fs", 
    "settings": {
        "location": "/opt/backup_es",
        "compress": true
    }
}
 
// 查看仓库的状态
http://192.168.1.1:9200/_snapshot
```





```
GET _snapshot/

PUT _snapshot/solar_es_backup_2020_08
{
    "type": "fs", 
    "settings": {
        "location": "solar_es_backup_2020_08",
        "compress": false
    }
}

GET _snapshot/solar_es_backup_2020_08/_all

GET _snapshot/solar_es_backup_2020_08/backup_snapshot_2020_08_15_09_20_30/

GET _snapshot/solar_es_backup_2020_08/backup_snapshot_2020_08_15_09_20_30/_status

GET _snapshot/solar_es_backup_2020_08/backup_snapshot_*



POST _snapshot/solar_es_backup_2020_08/backup_snapshot_2020_08_15_09_20_30/_restore

GET _snapshot/solar_es_backup_2020_08/backup_snapshot_2020_08_15_09_20_30/_status


GET /_recovery/

GET /device_log_2020-08/_recovery/
```



test为例

```
GET _search
{
  "query": {
    "match_all": {}
  }
}


GET _snapshot/


PUT _snapshot/test
{
    "type": "fs", 
    "settings": {
        "location": "test",
        "compress": false
    }
}

PUT _snapshot/test/snapshot_1?wait_for_completion=false
{
    "indices": "service_log_2020-08,device_log_2020-08,device_log_2020-09",
      "ignore_unavailable": true
}

GET _snapshot/test
GET _snapshot/test/_all


POST _snapshot/test/backup_snapshot_2020_08_15_09_20_30/_restore
{
  "indices": "service_log_2021-01",
  "index_settings": {
    "index.number_of_replicas": 6
  }
  
}

GET _snapshot/test/backup_snapshot_*

GET _snapshot/test/backup_snapshot_2020_08_15_09_20_30
GET _snapshot/test/backup_snapshot_2020_08_15_09_20_30/_status

GET _snapshot/_all

GET /_recovery/

GET /device_log_2020-08/_recovery/

```

